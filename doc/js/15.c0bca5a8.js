(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{b85c:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"row items-center justify-evenly"},[a("div",{staticClass:"full-page-wrapper"},[a("div",{staticClass:"full-page-header q-my-lg q-py-lg"},[a("div",{staticClass:"text-h4 text-center q-py-md"},[e._v("You are invited to video-chat room.")]),a("div",{staticClass:"text-h6 text-center"},[e._v("Please wait, we add you to this room!")])])])])},s=[],n=a("60a3"),i=a("a6c8"),c=function(e,t,a,o){var s,n=arguments.length,i=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,a,o);else for(var c=e.length-1;c>=0;c--)(s=e[c])&&(i=(n<3?s(i):n>3?s(t,a,i):s(t,a))||i);return n>3&&i&&Object.defineProperty(t,a,i),i},r=function(e,t,a,o){function s(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function i(e){try{r(o.next(e))}catch(t){n(t)}}function c(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):s(e.value).then(i,c)}r((o=o.apply(e,t||[])).next())}))};let u=class extends n["d"]{updateFirebaseData(e){return r(this,void 0,void 0,(function*(){const{uid:t}=this.$store.state.userModule,a={uid:t,task:""},o=i["c"].batch(),s=i["c"].collection("rooms").doc(e),n=s.collection("users").doc(t);o.update(s,{userIds:i["e"].FieldValue.arrayUnion(t)}),yield n.get().then((t=>{t.exists?(a.updatedAt=i["e"].FieldValue.serverTimestamp(),o.update(n,a)):(a.createdAt=i["e"].FieldValue.serverTimestamp(),o.set(n,a)),o.commit().then((()=>{s.get().then((t=>{i["c"].collection("rooms").doc(e).update({activeCandidatesCount:t.data().userIds.length})}))}))})),yield i["c"].collection("users").doc(t).update({roomId:e}).then((()=>{this.$router.push({name:"VideoChatTable",params:{roomId:e}})}))}))}mounted(){const{roomId:e}=this.$route.params;i["c"].collection("rooms").doc(e).get().then((t=>{if(t.exists){const{activeCandidatesCount:a,status:o}=t.data();a<4&&"active"===o?this.$store.getters["authModule/isAuth"]?this.updateFirebaseData(e):(this.$q.loading.show(),this.$store.dispatch("authModule/loginAsGuest").then((()=>{this.$q.loading.hide(),this.$q.notify({icon:"done",color:"positive",message:"You are signed in as a guest. Please create an account to have access to full functionality of the application."}),this.updateFirebaseData(e)}))):this.$router.push({name:"FullRoom"})}else this.$router.push({name:"FullRoom"})}))}};u=c([n["a"]],u);var l=u,d=l,h=a("2877"),p=a("9989"),f=a("eebe"),m=a.n(f),v=Object(h["a"])(d,o,s,!1,null,null,null);t["default"]=v.exports;m()(v,"components",{QPage:p["a"]})}}]);